!function(a){function b(a,b){var c=a,d=b,e=(Math.round(Math.sqrt(Math.pow(c,2)+Math.pow(d,2))),Math.atan2(d,c)),f=Math.round(180*e/Math.PI);return 0>f&&(f=360-Math.abs(f)),215>=f&&f>=155||45>=f&&f>=0||360>=f&&f>=315?!0:!1}var c=[],d=function(b){return b.afmCarouselId||(b.afmCarouselId=a.uuid()),b.afmCarouselId};a.fn.carousel=function(a){for(var b,f,g=0;g<this.length;g++)f=d(this[g]),c[f]?b=c[f]:(b=new e(this[g],a),c[f]=b);return 1==this.length?b:this};var e=function(){var d=a.feat.cssTransformStart,e=a.feat.cssTransformEnd,f=function(b,d){if(this.container="string"==typeof b||b instanceof String?document.getElementById(b):b,!this.container)return void alert("Error finding container for carousel "+b);if(!(this instanceof f))return new f(b,d);for(var e in d)d.hasOwnProperty(e)&&(this[e]=d[e]);var g=this;af(this.container).bind("destroy",function(a){var b=g.container.afmCarouselId;window.removeEventListener("orientationchange",g.orientationHandler,!1),c[b]&&delete c[b],a.stopPropagation()}),this.pagingDiv=this.pagingDiv?document.getElementById(this.pagingDiv):null,this.container.style.overflow="hidden",this.vertical&&(this.horizontal=!1);var h=document.createElement("div");this.container.appendChild(h);for(var i=a(h),j=a(this.container),k=Array.prototype.slice.call(this.container.childNodes);k.length>0;){var l=k.splice(0,1);l=j.find(l),l.get(0)!=h&&i.append(l.get(0))}this.horizontal?(h.style.display="block",h.style["float"]="left"):h.style.display="block",this.el=h,this.refreshItems();var m=af(h);m.bind("touchmove",function(a){g.touchMove(a)}),m.bind("touchend",function(a){g.touchEnd(a)}),m.bind("touchstart",function(a){g.touchStart(a)}),this.orientationHandler=function(){g.onMoveIndex(g.carouselIndex,0)},window.addEventListener("orientationchange",this.orientationHandler,!1)};return f.prototype={wrap:!0,startX:0,startY:0,dx:0,dy:0,glue:!1,myDivWidth:0,myDivHeight:0,cssMoveStart:0,childrenCount:0,carouselIndex:0,vertical:!1,horizontal:!0,el:null,movingElement:!1,container:null,pagingDiv:null,pagingCssName:"carousel_paging",pagingCssNameSelected:"carousel_paging_selected",pagingFunction:null,lockMove:!1,okToMove:!1,touchStart:function(b){if(this.okToMove=!1,this.myDivWidth=numOnly(this.container.clientWidth),this.myDivHeight=numOnly(this.container.clientHeight),this.lockMove=!1,b.touches[0].target&&void 0!==b.touches[0].target.type){var c=b.touches[0].target.tagName.toLowerCase();if("select"===c||"input"===c||"button"===c)return}if(1===b.touches.length){this.movingElement=!0,this.startY=b.touches[0].pageY,this.startX=b.touches[0].pageX;var d=a.getCssMatrix(this.el);if(this.vertical)try{this.cssMoveStart=numOnly(d.f)}catch(e){this.cssMoveStart=0}else try{this.cssMoveStart=numOnly(d.e)}catch(e){this.cssMoveStart=0}}},touchMove:function(c){if(this.movingElement){if(c.touches.length>1)return this.touchEnd(c);var d={x:c.touches[0].pageX-this.startX,y:c.touches[0].pageY-this.startY};if(this.vertical){var e={x:0,y:0};this.dy=c.touches[0].pageY-this.startY,this.dy+=this.cssMoveStart,e.y=this.dy,c.preventDefault()}else{if(!(!this.lockMove&&b(d.x,d.y)||Math.abs(this.dx)>5))return this.lockMove=!0;var e={x:0,y:0};this.dx=c.touches[0].pageX-this.startX,this.dx+=this.cssMoveStart,c.preventDefault(),e.x=this.dx}var f=this.vertical?this.dy%this.myDivHeight/this.myDivHeight*100*-1:this.dx%this.myDivWidth/this.myDivWidth*100*-1;this.okToMove||(oldStateOkToMove=this.okToMove,this.okToMove=this.glue?Math.abs(f)>this.glue&&Math.abs(f)<100-this.glue:!0,this.okToMove&&!oldStateOkToMove&&a.trigger(this,"movestart",[this.el])),this.okToMove&&e&&this.moveCSS3(this.el,e)}},touchEnd:function(){if(this.movingElement){a.trigger(this,"movestop",[this.el]);var b=!1,c=a.getCssMatrix(this.el),d=numOnly(this.vertical?c.f:c.e),e=this.vertical?this.dy%this.myDivHeight/this.myDivHeight*100*-1:this.dx%this.myDivWidth/this.myDivWidth*100*-1,f=this.carouselIndex;d<this.cssMoveStart&&e>3?f++:d>this.cssMoveStart&&97>e&&f--;var g=f;this.wrap?(f>this.childrenCount-1&&(f=0,g=this.childrenCount),0>f&&(f=this.childrenCount-1,g=-1)):(0>f&&(f=0),f>this.childrenCount-1&&(f=this.childrenCount-1),g=f);var h={x:0,y:0};if(this.vertical?h.y=g*this.myDivHeight*-1:h.x=g*this.myDivWidth*-1,this.moveCSS3(this.el,h,"150"),this.pagingDiv&&this.carouselIndex!==f&&(document.getElementById(this.container.id+"_"+this.carouselIndex).className=this.pagingCssName,document.getElementById(this.container.id+"_"+f).className=this.pagingCssNameSelected),this.carouselIndex!=f&&(b=!0),this.carouselIndex=f,this.wrap&&g!=f){var i=this;window.setTimeout(function(){i.onMoveIndex(f,"1ms")},155)}this.dx=0,this.movingElement=!1,this.startX=0,this.dy=0,this.startY=0,b&&this.pagingFunction&&"function"==typeof this.pagingFunction&&this.pagingFunction(this.carouselIndex)}},onMoveIndex:function(a,b){this.myDivWidth=numOnly(this.container.clientWidth),this.myDivHeight=numOnly(this.container.clientHeight);var c=!1;document.getElementById(this.container.id+"_"+this.carouselIndex)&&(document.getElementById(this.container.id+"_"+this.carouselIndex).className=this.pagingCssName);var d=Math.abs(a-this.carouselIndex),e=a;0>e&&(e=0),e>this.childrenCount-1&&(e=this.childrenCount-1);var f={x:0,y:0};this.vertical?f.y=e*this.myDivHeight*-1:f.x=e*this.myDivWidth*-1;var g=b?b:50+parseInt(20*d);if(this.moveCSS3(this.el,f,g),this.carouselIndex!=e&&(c=!0),this.carouselIndex=e,this.pagingDiv){var h=document.getElementById(this.container.id+"_"+this.carouselIndex);h&&(h.className=this.pagingCssNameSelected)}c&&this.pagingFunction&&"function"==typeof this.pagingFunction&&this.pagingFunction(currInd)},moveCSS3:function(b,c,f,g){f=f?parseInt(f):0,g||(g="linear"),b.style[a.feat.cssPrefix+"Transform"]="translate"+d+c.x+"px,"+c.y+"px"+e,b.style[a.feat.cssPrefix+"TransitionDuration"]=f+"ms",b.style[a.feat.cssPrefix+"BackfaceVisibility"]="hidden",b.style[a.feat.cssPrefix+"TransitionTimingFunction"]=g},addItem:function(a){a&&a.nodeType&&(this.container.childNodes[0].appendChild(a),this.refreshItems())},refreshItems:function(){var b=0,c=this,d=this.el;a(d).children().find(".prevBuffer").remove(),a(d).children().find(".nextBuffer").remove(),n=d.childNodes[0];for(var e,f=[];n;n=n.nextSibling)1===n.nodeType&&(f.push(n),b++);if(this.wrap){var g=a(f[f.length-1]).clone().get(0);a(d).prepend(g);var h=a(f[0]).clone().get(0);a(d).append(h),f.push(h),f.unshift(g),h.style.position="absolute",g.style.position="absolute"}this.childrenCount=b,e=parseFloat(100/b)+"%";for(var i=0;i<f.length;i++)this.horizontal?(f[i].style.width=e,f[i].style.height="100%",f[i].style["float"]="left"):(f[i].style.height=e,f[i].style.width="100%",f[i].style.display="block");if(this.moveCSS3(d,{x:0,y:0}),this.horizontal?(d.style.width=Math.ceil(100*this.childrenCount)+"%",d.style.height="100%",d.style["min-height"]="100%",this.wrap&&(g.style.left="-"+e,h.style.left="100%")):(d.style.width="100%",d.style.height=Math.ceil(100*this.childrenCount)+"%",d.style["min-height"]=Math.ceil(100*this.childrenCount)+"%",this.wrap&&(g.style.top="-"+e,h.style.top="100%")),this.pagingDiv){for(this.pagingDiv.innerHTML="",i=0;i<this.childrenCount;i++){var j=document.createElement("div");j.id=this.container.id+"_"+i,j.pageId=i,j.className=i!==this.carouselIndex?this.pagingCssName:this.pagingCssNameSelected,j.onclick=function(){c.onMoveIndex(this.pageId)};var k=document.createElement("div");k.style.width="20px",this.horizontal?(k.style.display="inline-block",k.innerHTML="&nbsp;"):(k.innerHTML="&nbsp;",k.style.display="block"),this.pagingDiv.appendChild(j),i+1<this.childrenCount&&this.pagingDiv.appendChild(k),j=null,k=null}this.horizontal?(this.pagingDiv.style.width=50*this.childrenCount+"px",this.pagingDiv.style.height="25px"):(this.pagingDiv.style.height=50*this.childrenCount+"px",this.pagingDiv.style.width="25px")}this.onMoveIndex(this.carouselIndex)}},f}()}(af),window.APPCONF={BAAS_APP_CODE:"1234567890",URLS:{SIGNUP:"http://baasbox-cog4.rhcloud.com/user",LOGIN:"http://baasbox-cog4.rhcloud.com/login",CHANGEPASS:"http://baasbox-cog4.rhcloud.com/me/password",LOGOUT:"http://baasbox-cog4.rhcloud.com/logout",RESETPASS:"http://baasbox-cog4.rhcloud.com/user/:username/password/reset",DOCUMENTS:"http://search2.cogfor.com:9200/hhs/_search"}},window.helpers={serializeFormToArray:function(a){var b={};return a.find("input[name], textarea[name]").each(function(a,c){var d=$(c);b[d.attr("name")]=d.val()}),b}},Handlebars.registerHelper("ifEquals",function(a,b,c){return a==b?c.fn(this):c.inverse(this)}),Handlebars.registerHelper("ifDivisionEquals",function(a,b,c,d){return(a+1)%b==c?d.fn(this):d.inverse(this)}),Handlebars.registerHelper("ifObjProp",function(a,b,c){return a&&a[b]?c.fn(this):c.inverse(this)}),Handlebars.registerHelper("ifExceedLength",function(a,b,c){return a.length>=b?c.fn(this):c.inverse(this)}),Handlebars.registerHelper("random",function(a){var b=1;return Math.floor(Math.random()*(a-b+1)+b)}),window.Paperapp={Models:{},models:{},Collections:{},collections:{},Views:{},views:{},init:function(){Paperapp.views.appView=new Paperapp.Views.AppView}},function(){var a,b,c,d;a=_.Deferred(),b=_.Deferred(),window.DocumentTouch&&document instanceof DocumentTouch||"ontouchstart"in window||(c=document.createElement("script"),c.src="bower_components/intel-appframework/plugins/af.desktopBrowsers.js",d=$("head").append(c),$.os.android=!0,$.os.desktop=!0,window.device={platform:"Android"},b.resolve()),$.ui.autoLaunch=!1,document.addEventListener("deviceready",b.resolve,!0),document.addEventListener("DOMContentLoaded",a.resolve,!1),_.when([b,a]).then(function(){window.Paperapp.init()})}(),this.JST=this.JST||{},this.JST["app/scripts/templates/app.hbs"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f="";return f}),this.JST["app/scripts/templates/carousel-slide.hbs"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing;return i+='<a href="#" style="background-image:url(images/demopic-small-',h={hash:{},data:e},f=c.random||b.random,g=f?f.call(b,3,h):j.call(b,"random",3,h),(g||0===g)&&(i+=g),i+='.jpg)" class="carousel_image"></a>'}),this.JST["app/scripts/templates/carousel.hbs"]=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f,l="";return l+="\n	",f={hash:{},inverse:p.noop,fn:p.program(2,g,b),data:b},d=c.ifDivisionEquals||a.ifDivisionEquals,e=d?d.call(a,(d=b,null==d||d===!1?d:d.index),3,1,f):q.call(a,"ifDivisionEquals",(d=b,null==d||d===!1?d:d.index),3,1,f),(e||0===e)&&(l+=e),l+="\n		\n		",f={hash:{},inverse:p.noop,fn:p.program(4,h,b),data:b},d=c.ifDivisionEquals||a.ifDivisionEquals,e=d?d.call(a,(d=b,null==d||d===!1?d:d.index),3,0,f):q.call(a,"ifDivisionEquals",(d=b,null==d||d===!1?d:d.index),3,0,f),(e||0===e)&&(l+=e),l+="\n		\n		",f={hash:{},inverse:p.noop,fn:p.program(6,i,b),data:b},d=c.ifDivisionEquals||a.ifDivisionEquals,e=d?d.call(a,(d=b,null==d||d===!1?d:d.index),3,1,f):q.call(a,"ifDivisionEquals",(d=b,null==d||d===!1?d:d.index),3,1,f),(e||0===e)&&(l+=e),l+="\n		\n		",f={hash:{},inverse:p.noop,fn:p.program(8,j,b),data:b},d=c.ifDivisionEquals||a.ifDivisionEquals,e=d?d.call(a,(d=b,null==d||d===!1?d:d.index),3,2,f):q.call(a,"ifDivisionEquals",(d=b,null==d||d===!1?d:d.index),3,2,f),(e||0===e)&&(l+=e),l+="\n		\n	",f={hash:{},inverse:p.noop,fn:p.program(10,k,b),data:b},d=c.ifDivisionEquals||a.ifDivisionEquals,e=d?d.call(a,(d=b,null==d||d===!1?d:d.index),3,0,f):q.call(a,"ifDivisionEquals",(d=b,null==d||d===!1?d:d.index),3,0,f),(e||0===e)&&(l+=e),l+="\n"}function g(){return'\n		<!-- div class="carousel_slide" -->\n	'}function h(a,b){var d,e="";return e+='\n			<a href="#" style="background-image:url(images/demopic-small-1.jpg)" class="carousel_image" data-id="',(d=c.id)?d=d.call(a,{hash:{},data:b}):(d=a.id,d=typeof d===n?d.apply(a):d),e+=o(d)+'"></a>\n		'}function i(){return'\n			<a href="#" style="background-image:url(images/demopic-small-2.jpg)" class="carousel_image"></a>\n		'}function j(){return'\n			<a href="#" style="background-image:url(images/demopic-small-3.jpg)" class="carousel_image"></a>\n		'}function k(){return"\n		<!-- /div -->\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m="",n="function",o=this.escapeExpression,p=this,q=c.helperMissing;return m+='<div class="carousel_wrapper">\n',l=c.each.call(b,b.slides,{hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e}),(l||0===l)&&(m+=l),m+="\n</div>"}),this.JST["app/scripts/templates/full-page.hbs"]=Handlebars.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<div class="full-page_bg"></div>\n\n<div class="full-page_content">\n	<header class="full-page-header"></header>\n	<h3 class="full-page_title">',(f=c.title)?f=f.call(b,{hash:{},data:e}):(f=b.title,f=typeof f===h?f.apply(b):f),g+=i(f)+'</h3>\n	<p class="full-page_author">',(f=c.author)?f=f.call(b,{hash:{},data:e}):(f=b.author,f=typeof f===h?f.apply(b):f),g+=i(f)+'</p>\n	<p class="full-page_text">',(f=c["abstract"])?f=f.call(b,{hash:{},data:e}):(f=b["abstract"],f=typeof f===h?f.apply(b):f),g+=i(f)+"</p>\n</div>"}),this.JST["app/scripts/templates/settings.hbs"]=Handlebars.template(function(a,b,c,d,e){function f(){return'\n	<a href="#changepass-page" class="button m-settings m-first" id="user-changepass" title="Login">Change password</a>\n	<a href="#" class="button m-settings" id="user-logout" title="Login">Logout</a>\n	\n'}function g(){return'\n	<a href="#login-page" class="button m-settings m-first" id="user-login" title="Login">Login</a>\n	<a href="#signup-page" class="button m-settings" id="user-signup" title="Signup">Signup</a>\n	<a href="#resetpass-page" class="button m-settings" id="user-resetpass" title="Login">Reset password</a>\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i="",j=this;return i+='<input type="text" value="Search" class="search-field" />\n\n',h=c["if"].call(b,b.loggedIn,{hash:{},inverse:j.program(3,g,e),fn:j.program(1,f,e),data:e}),(h||0===h)&&(i+=h),i}),this.JST["app/scripts/templates/slider.hbs"]=Handlebars.template(function(a,b,c,d,e){function f(a){var b,c="";return c+='\n	<div class="slider_slide">\n		<span class="slider_nav-swipe-area"></span>\n		<span style="background-image:url(images/demopic.jpg)" class="slider_image"></span>\n		<h4 class="slider_author">'+j((b=a._source,b=null==b||b===!1?b:b.name,typeof b===i?b.apply(a):b))+'</h4>\n		<h5 class="slider_title">'+j((b=a._source,b=null==b||b===!1?b:b.title,typeof b===i?b.apply(a):b))+"</h5>\n	</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="",i="function",j=this.escapeExpression,k=this;return h+='<div class="slider_wrapper">\n',g=c.each.call(b,b.slides,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+="\n</div>"}),Paperapp.Views=Paperapp.Views||{},function(){Paperapp.Views.AppView=Backbone.View.extend({el:"body",events:{"submit #signup-form":"signup","submit #login-form":"login","click #user-logout":"logout","submit #changepass-form":"changepass","submit #resetpass-form":"resetpass","click #settings a":"settingsMenuHide","swipeDown .slider_nav-swipe-area":"settingsMenuShow","swipeUp #menu":"settingsMenuHide","swipeUp #settings":"settingsMenuHide","swipeUp #settings a":"settingsMenuHide","swipeUp #settings input":"settingsMenuHide","swipeUp #menu_scroller":"settingsMenuHide"},initialize:function(){var a=this;_.bindAll(this,"signup","login","logout","changepass","resetpass","settingsMenuShow"),Paperapp.models.userModel=new Paperapp.Models.UserModel,Paperapp.views.settingsView=new Paperapp.Views.SettingsView,Paperapp.views.sliderView=new Paperapp.Views.SliderView,Paperapp.views.carouselView=new Paperapp.Views.CarouselView,$.ui.backButtonText="Back",localStorage.getItem("_username")&&localStorage.getItem("_password")?Paperapp.models.userModel.login({username:localStorage.getItem("_username"),password:localStorage.getItem("_password")},!0,function(){window.setTimeout(function(){$.ui.launch()},100)}):(Paperapp.views.settingsView.render(),window.setTimeout(function(){$.ui.launch()},100)),$.ui.ready(function(){console.log("app framework launched"),$.ui.removeFooterMenu()}),Paperapp.models.userModel.on("signupComplete",function(a){Paperapp.models.userModel.login({username:a.username,password:a.password},!0)}),Paperapp.models.userModel.on("change:username",function(){localStorage.setItem("_username",Paperapp.models.userModel.get("username"))}),Paperapp.models.userModel.on("change:password",function(){localStorage.setItem("_password",Paperapp.models.userModel.get("password"))}),Paperapp.models.userModel.on("loginComplete",function(){a.updateUserName(),Paperapp.views.settingsView.render()}),Paperapp.models.userModel.on("loginFailed",function(){Paperapp.views.settingsView.render()}),Paperapp.models.userModel.on("loggedOut",function(){localStorage.removeItem("_username"),localStorage.removeItem("_password"),a.updateUserName(),Paperapp.views.settingsView.render()}),Paperapp.models.userModel.on("passwordUpdated",function(){Paperapp.models.userModel.login({username:localStorage.getItem("_username"),password:localStorage.getItem("_password")},!0)})},signup:function(a){a.preventDefault();var b=$(a.currentTarget);Paperapp.models.userModel.signup(helpers.serializeFormToArray(b))},login:function(a){a.preventDefault();var b=$(a.currentTarget);Paperapp.models.userModel.login(helpers.serializeFormToArray(b))},logout:function(a){a.preventDefault(),Paperapp.models.userModel.logout()},changepass:function(a){a.preventDefault();var b=$(a.currentTarget);Paperapp.models.userModel.changepass(helpers.serializeFormToArray(b))},resetpass:function(a){a.preventDefault();var b=$(a.currentTarget);Paperapp.models.userModel.resetpass(helpers.serializeFormToArray(b))},updateUserName:function(){$("#main .username").text(Paperapp.models.userModel.get("username"))},popup:function(a,b,c){$.ui.popup({title:a,message:b,doneText:"ok",cancelText:"",doneCallback:function(){c&&$.ui.loadContent("#main")}})},settingsMenuShow:function(){var a=$("#menu");a.css3Animate({y:190,time:200,complete:function(){a.addClass("active")}})},settingsMenuHide:function(){var a=$("#menu");a.css3Animate({y:0,time:200,complete:function(){a.removeClass("active")}})},setMenuHeight:function(){$("#menu").css("height","auto"),setTimeout(function(){$("#menu").css("height",$("#menu").get(0).offsetHeight)},0)}})}(),Paperapp.Views=Paperapp.Views||{},function(){"use strict";Paperapp.Views.SettingsView=Backbone.View.extend({template:JST["app/scripts/templates/settings.hbs"],el:"#settings",initialize:function(){},render:function(){this.$el.html(this.template({loggedIn:Paperapp.models.userModel.get("session")?!0:!1}))}})}(),Paperapp.Views=Paperapp.Views||{},function(){Paperapp.Views.SliderView=Backbone.View.extend({el:"#slider",template:JST["app/scripts/templates/slider.hbs"],events:{},initialize:function(){var a=this;Paperapp.collections.sliderDocuments=new Paperapp.Collections.DocumentsCollection({source:{from:0,size:10,sort:[{date:{order:"desc"}}]}}),Paperapp.collections.sliderDocuments.bind("reset",function(){a.render()})},render:function(){var a=this;a.$el.html(a.template({slides:Paperapp.collections.sliderDocuments.toJSON()})),setTimeout(function(){a.wrapper=a.$el.find(".slider_wrapper"),a.wrapper.css("width",$(window).width()),a.wrapper.css("height",$(window).height()),a.wrapper.carousel({pagingDiv:"slider-nav",pagingCssName:"slider-nav_link",pagingCssNameSelected:"slider-nav_link m-active"})},0)}})}(),Paperapp.Models=Paperapp.Models||{},function(){Paperapp.Models.UserModel=Backbone.Model.extend({initialize:function(){this.session},defaults:{username:"",session:void 0},validate:function(){},parse:function(a){return a},login:function(a,b,c){var d=this;$.ajax({url:APPCONF.URLS.LOGIN,type:"POST",dataType:"JSON",beforeSend:function(b){b.setRequestHeader("X-BAASBOX-APPCODE",APPCONF.BAAS_APP_CODE),b.setRequestHeader("Authentication","Basic "+Base64.encode(a.username+":"+a.password))},data:$.extend(a,{appcode:APPCONF.BAAS_APP_CODE}),success:function(e){e=JSON.parse(e),d.set("session",e.data["X-BB-SESSION"]),d.set("username",a.username),d.set("password",a.password),b||Paperapp.views.appView.popup("You have succesfully logged in","",!0),d.trigger("loginComplete",a),c&&c()},error:function(){d.trigger("loginFailed",a),c&&c(),b||Paperapp.views.appView.popup("Login error","",!1)}})},signup:function(a){var b=this;$.ajax({url:APPCONF.URLS.SIGNUP,type:"POST",dataType:"JSON",contentType:"application/json",beforeSend:function(b){b.setRequestHeader("X-BAASBOX-APPCODE",APPCONF.BAAS_APP_CODE),b.setRequestHeader("Authentication","Basic "+Base64.encode(a.username+":"+a.password))},data:JSON.stringify({username:a.username,password:a.password,appcode:APPCONF.BAAS_APP_CODE,visibleByTheUser:{email:a.email}}),success:function(){Paperapp.views.appView.popup("Signup successful","",!0),b.trigger("signupComplete",a)},error:function(a){a.responseText.length?Paperapp.views.appView.popup("Signup error",a.responseText,!1):Paperapp.views.appView.popup("Signup error","response is empty",!1)}})},logout:function(){var a=this;$.ajax({url:APPCONF.URLS.LOGOUT,type:"POST",beforeSend:function(b){b.setRequestHeader("X-BAASBOX-APPCODE",APPCONF.BAAS_APP_CODE),b.setRequestHeader("X-BB-SESSION",a.get("session"))},success:function(){a.set("session",""),a.set("username",""),a.set("password",""),a.trigger("loggedOut",[]),Paperapp.views.appView.popup("You have been logged out","",!0)},error:function(){}})},changepass:function(a){var b=this;$.ajax({url:APPCONF.URLS.CHANGEPASS,type:"PUT",dataType:"JSON",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("X-BAASBOX-APPCODE",APPCONF.BAAS_APP_CODE),a.setRequestHeader("X-BB-SESSION",b.get("session")),a.setRequestHeader("Authentication","Basic "+Base64.encode(b.get("username")+":"+b.get("password")))},data:JSON.stringify(a),success:function(){Paperapp.views.appView.popup("Your password changed","",!0),b.set("password",a["new"]),b.trigger("passwordUpdated",[])},error:function(a){Paperapp.views.appView.popup("Password change error",a.errorCode,!1)}})},resetpass:function(a){var b=APPCONF.URLS.RESETPASS.replace(":username",a.username);$.ajax({url:b,type:"GET",beforeSend:function(a){a.setRequestHeader("X-BAASBOX-APPCODE",APPCONF.BAAS_APP_CODE)},success:function(){Paperapp.views.appView.popup("Password reset request send, check your email.","",!0)},error:function(a){Paperapp.views.appView.popup("Password reset request error",a.responseText,!1)}})}})}(),Paperapp.Models=Paperapp.Models||{},function(){Paperapp.Models.DocumentModel=Backbone.Model.extend({initialize:function(){},defaults:{},validate:function(){},parse:function(a){return a}})}(),Paperapp.Collections=Paperapp.Collections||{},function(){Paperapp.Collections.DocumentsCollection=Backbone.Collection.extend({model:Paperapp.Models.DocumentModel,url:APPCONF.URLS.DOCUMENTS,initialize:function(a){this.source=a.source,this.url=this.url+"?source="+JSON.stringify(a.source),this.fetch({reset:!0})},parse:function(a){return a.hits.hits}})}(),Paperapp.Views=Paperapp.Views||{},function(){Paperapp.Views.CarouselView=Backbone.View.extend({el:"#carousel",template:JST["app/scripts/templates/carousel.hbs"],events:{},initialize:function(){var a=this;a.wrapper=a.$el.find(".carousel_wrapper"),Paperapp.collections.carouselDocuments=new Paperapp.Collections.DocumentsCollection({source:{query:{query_string:{query:"*:*"}},from:0,size:9,sort:{_script:{script:"Math.random()",type:"number",params:{},order:"asc"}}}}),Paperapp.collections.carouselDocuments.bind("reset",function(){a.render(),setTimeout(function(){var b=a.$el.find(".carousel_slide").eq(0);a.$el.find(".carousel_slide").css({width:b.get(0).offsetWidth,marginRight:b.css("marginRight")}),a.$el.addClass("m-visible"),device&&device.platform&&"Android"===device.platform&&(document.addEventListener("touchmove",function(a){a.preventDefault()},!1),myScroll=new IScroll("#carousel",{scrollX:!0,scrollY:!1,keyBindings:!0}))},0)})},render:function(){var a=this;Paperapp.views.carouselSlides=[],Paperapp.collections.carouselDocuments.each(function(b){var c=new Paperapp.Views.CarouselSlideView({model:b});a.wrapper.append(c.$el),Paperapp.views.carouselSlides.push(c)})}})}(),Paperapp.Views=Paperapp.Views||{},function(){Paperapp.Views.FullPageView=Backbone.View.extend({className:"full-page",tagName:"div",events:{click:"openURL",swipeDown:"close","swipeDown .full-page_bg":"close","swipeDown .full-page_content":"close","swipeDown .full-page_title":"close","swipeDown .full-page_author":"close","swipeDown .full-page_text":"close"},template:JST["app/scripts/templates/full-page.hbs"],initialize:function(){var a=this;_.bindAll(this,"open","close","openURL"),a.pageId=a.$el.get().className+"-"+a.model.cid,a.render(),setTimeout(function(){},0)},render:function(){this.$el.html(this.template(this.model.get("_source"))),this.$el.appendTo("body")},open:function(){this.$el.addClass("m-visible")},close:function(){this.$el.removeClass("m-visible")},openURL:function(a){a.preventDefault(),window.open(this.model.get("_source").url,"_blank","location=yes")}})}(),Paperapp.Views=Paperapp.Views||{},function(){"use strict";Paperapp.Views.CarouselSlideView=Backbone.View.extend({className:"carousel_slide",tagName:"div",template:JST["app/scripts/templates/carousel-slide.hbs"],fullPageView:void 0,events:{swipeUp:"expand"},initialize:function(){this.render(),_.bindAll(this,"expand"),Paperapp.views.fullPages=[]},render:function(){this.$el.html(this.template({}))},expand:function(){var a=this;return a.fullPageView?void a.fullPageView.open():(Paperapp.views.fullPages.push(a.fullPageView),a.fullPageView=new Paperapp.Views.FullPageView({model:this.model}),a.fullPageView.$el.css({top:this.$el.offset().top,left:this.$el.offset().left}),void setTimeout(function(){a.fullPageView.open()},0))}})}();